import{j as a}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BVOCwoKb.js";import{r as U,a as A}from"./movieUtils.BzFiPXDS.js";function Y({initialData:m,initialSlug:h,baseUrl:y,initialLimit:u,tittle:S}){const[p,_]=r.useState(m?.items||[]),[w,q]=r.useState(m?.params?.pagination||{current_page:1,total_pages:1}),[i,j]=r.useState(!1),[g,N]=r.useState(null),[b,C]=r.useState(!1),[n,M]=r.useState(h),[l,P]=r.useState(()=>{const e=m?.params||{};return{quoc_gia:e.filterCountry?.[0]||"",the_loai:e.filterCategory?.[0]||"",ngon_ngu:e.filterType?.[0]||"",nam_phat_hanh:e.filterYear?.[0]||"",sort_field:e.sortField||"_id",sort_type:e.sortType||"desc"}}),o=w.current_page,v=w.total_pages,B=[{label:"Tất cả",value:""},{label:"Việt Nam",value:"viet-nam"},{label:"Hàn Quốc",value:"han-quoc"},{label:"Mỹ",value:"au-my"},{label:"Trung Quốc",value:"trung-quoc"},{label:"Nhật Bản",value:"nhat-ban"},{label:"Thái Lan",value:"thai-lan"},{label:"Hồng Kông",value:"hong-kong"},{label:"Đài Loan",value:"dai-loan"},{label:"Ấn Độ",value:"an-do"},{label:"Anh",value:"anh"},{label:"Pháp",value:"phap"},{label:"Canada",value:"canada"},{label:"Đức",value:"duc"},{label:"Ý",value:"y"},{label:"Tây Ban Nha",value:"tay-ban-nha"},{label:"Úc",value:"uc"},{label:"Nga",value:"nga"},{label:"Philippines",value:"philippines"},{label:"Indonesia",value:"indonesia"},{label:"Singapore",value:"sg"},{label:"Malaysia",value:"my"},{label:"Mexico",value:"mx"},{label:"Đan Mạch",value:"dk"},{label:"Thụy Điển",value:"se"},{label:"Thụy Sĩ",value:"ch"},{label:"Ukraina",value:"ua"},{label:"Ba Lan",value:"pl"},{label:"Bồ Đào Nha",value:"pt"},{label:"UAE",value:"ae"},{label:"Ả Rập Xê Út",value:"sa"},{label:"Thổ Nhĩ Kỳ",value:"tr"},{label:"Brazil",value:"br"},{label:"Nam Phi",value:"za"},{label:"Na Uy",value:"no"},{label:"Châu Phi",value:"xx"},{label:"Quốc Gia Khác",value:"zz"}],z=[{label:"Tất cả",value:""},{label:"Hành Động",value:"hanh-dong"},{label:"Cổ Trang",value:"co-trang"},{label:"Viễn Tưởng",value:"vien-tuong"},{label:"Bí Ẩn",value:"bi-an"},{label:"Tâm Lý",value:"tam-ly"},{label:"Âm Nhạc",value:"am-nhac"},{label:"Phiêu Lưu",value:"phieu-luu"},{label:"Chính Kịch",value:"chinh-kich"},{label:"Khoa Học",value:"khoa-hoc"},{label:"Học Đường",value:"hoc-duong"},{label:"Võ Thuật",value:"vo-thuat"},{label:"Chiến Tranh",value:"chien-tranh"},{label:"Hình Sự",value:"hinh-su"},{label:"Gia Đình",value:"gia-dinh"},{label:"Tình Cảm",value:"tinh-cam"},{label:"Thần Thoại",value:"than-thoai"},{label:"Thể Thao",value:"the-thao"},{label:"Kinh Dị",value:"kinh-di"},{label:"Kinh Điển",value:"kinh-dien"}],H=[{label:"Tất cả",value:""},{label:"Vietsub",value:"vietsub"},{label:"Thuyết Minh",value:"thuyet-minh"},{label:"Lồng Tiếng",value:"long-tieng"}],K=[{label:"Tất cả",value:""},...Array.from({length:new Date().getFullYear()-1970+1},(e,t)=>({label:`${new Date().getFullYear()-t}`,value:`${new Date().getFullYear()-t}`})).sort((e,t)=>parseInt(t.value)-parseInt(e.value))],F=[{label:"Mới nhất (theo ID)",value:"_id"},{label:"Thời gian cập nhật",value:"modified.time"},{label:"Năm phát hành",value:"year"}],T=r.useCallback((e=1)=>{const t=new URL(`${y}/v1/api/quoc-gia/${n}`);return t.searchParams.set("page",e.toString()),t.searchParams.set("limit",u.toString()),l.sort_field&&t.searchParams.set("sort_field",l.sort_field),l.sort_type&&t.searchParams.set("sort_type",l.sort_type),l.ngon_ngu&&t.searchParams.set("sort_lang",l.ngon_ngu),l.the_loai&&t.searchParams.set("category",l.the_loai),l.quoc_gia&&l.quoc_gia!==n?t.searchParams.set("country",l.quoc_gia):l.quoc_gia===""&&t.searchParams.delete("country"),l.nam_phat_hanh&&t.searchParams.set("year",l.nam_phat_hanh),t.toString()},[l,y,n,u]),x=r.useCallback(async(e=1)=>{j(!0),N(null);try{const t=T(e),d=await fetch(t);if(!d.ok)throw new Error(`Lỗi khi fetch API: ${t} - Status: ${d.status}`);const L=await d.json();_(L.data?.items||[]),q(L.data?.params?.pagination||{current_page:1,total_pages:1});const s=new URL(`${window.location.origin}/quoc-gia/${n}`);s.searchParams.set("page",e.toString()),s.searchParams.set("limit",u.toString()),l.sort_field?s.searchParams.set("sort_field",l.sort_field):s.searchParams.delete("sort_field"),l.sort_type?s.searchParams.set("sort_type",l.sort_type):s.searchParams.delete("sort_type"),l.ngon_ngu?s.searchParams.set("sort_lang",l.ngon_ngu):s.searchParams.delete("sort_lang"),l.the_loai?s.searchParams.set("category",l.the_loai):s.searchParams.delete("category"),l.quoc_gia&&l.quoc_gia!==n?s.searchParams.set("country",l.quoc_gia):s.searchParams.delete("country"),l.nam_phat_hanh?s.searchParams.set("year",l.nam_phat_hanh):s.searchParams.delete("year"),window.history.pushState(null,"",s.toString())}catch{N("Không thể tải phim. Vui lòng thử lại."),_([])}finally{j(!1)}},[T,l,u,n]),c=(e,t)=>{P(d=>({...d,[e]:t}))},E=()=>{x(1)},f=e=>{x(e)};r.useEffect(()=>{h!==n&&(M(h),P({quoc_gia:h,the_loai:"",ngon_ngu:"",nam_phat_hanh:"",sort_field:"_id",sort_type:"desc"}),x(1))},[h,n,x]);const k=[],$=Math.max(1,o-2),I=Math.min(v,$+4);for(let e=$;e<=I;e++)k.push(e);return a.jsxs("div",{children:[a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"flex flex-row items-center justify-between gap-8 lg:justify-start",children:[a.jsx("h1",{className:"lg:text-xl text-lg font-semibold text-white",children:S}),a.jsxs("button",{onClick:()=>C(!b),className:"flex items-center gap-1 transition-all",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"leading-none",children:a.jsx("path",{d:"M19 6H5c-1.1 0-1.4.6-.6 1.4l4.2 4.2c.8.8 1.4 2.3 1.4 3.4v5l4-2v-3.5c0-.8.6-2.1 1.4-2.9l4.2-4.2c.8-.8.5-1.4-.6-1.4"})}),a.jsx("span",{className:"text-xs font-medium leading-none text-white",children:"Bộ lọc"}),a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:`leading-none transition-transform duration-300 ${b?"rotate-180":"rotate-0"}`,children:a.jsx("path",{d:"M12 13.172L18.364 6.808l1.414 1.414L12 16L4.222 8.222l1.414-1.414L12 13.172z"})})]})]}),b&&a.jsxs("div",{className:"mt-4 flex flex-col gap-4 text-xs text-white border border-gray-200/20 rounded-lg p-4",children:[a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 font-semibold",children:"Quốc gia:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:B.map(e=>a.jsx("button",{onClick:()=>c("quoc_gia",e.value),className:`rounded-lg px-3 py-1.5 ${l.quoc_gia===e.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 font-semibold",children:"Thể loại:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:z.map(e=>a.jsx("button",{onClick:()=>c("the_loai",e.value),className:`rounded-lg px-3 py-1.5 ${l.the_loai===e.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 font-semibold",children:"Ngôn ngữ:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:H.map(e=>a.jsx("button",{onClick:()=>c("ngon_ngu",e.value),className:`rounded-lg px-3 py-1.5 ${l.ngon_ngu===e.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 font-semibold",children:"Năm sản xuất:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:K.map(e=>a.jsx("button",{onClick:()=>c("nam_phat_hanh",e.value),className:`rounded-lg px-3 py-1.5 ${l.nam_phat_hanh===e.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:e.label},e.value))})]}),a.jsxs("div",{children:[a.jsx("p",{className:"mb-2 font-semibold",children:"Sắp xếp:"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[F.map(e=>a.jsx("button",{onClick:()=>c("sort_field",e.value),className:`rounded-lg px-3 py-1.5 ${l.sort_field===e.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:e.label},e.value)),a.jsx("button",{onClick:()=>c("sort_type",l.sort_type==="desc"?"asc":"desc"),className:`rounded-[4px] px-3 py-1 transition-colors duration-200 ${l.sort_type==="desc"?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-white"}`,children:l.sort_type==="desc"?"Giảm dần":"Tăng dần"})]})]}),a.jsxs("div",{className:"flex justify-start gap-2 mt-4",children:[a.jsx("button",{onClick:E,className:"rounded-full border border-[#ffd785] bg-[#ffd785] px-4 py-2 text-xs font-semibold text-black",disabled:i,children:"Tìm Kiếm"}),a.jsx("button",{onClick:()=>C(!1),className:"rounded-full border border-white px-4 py-2 text-xs font-semibold text-white ",children:"Đóng"})]})]})]}),i&&a.jsx("div",{className:"mt-8 text-center text-white",children:"Đang tải phim..."}),g&&a.jsx("div",{className:"mt-8 text-center text-red-500",children:g}),!i&&!g&&p.length===0&&a.jsx("div",{className:"mt-8 text-center text-gray-400",children:"Không tìm thấy phim nào phù hợp."}),!i&&!g&&p.length>0&&a.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",children:p.map(e=>{const t=`https://ik.imagekit.io/17mpki7mv/motchill/${e.poster_url}?tr=f-webp,w-300,h-450,fo-auto,q-85`;return a.jsxs("a",{href:`/phim/${e.slug}`,className:"group relative flex-shrink-0",children:[a.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden rounded-[4px]",children:[a.jsx("img",{src:t,alt:`Poster phim ${e.name}`,className:"h-full w-full object-cover",loading:"lazy"}),a.jsx("div",{className:"absolute bottom-0 left-0 h-[40%] w-full rounded-b-[4px]",style:{background:"linear-gradient(to top,rgba(30, 30, 30, 0.8) 5%, transparent 100%)"},"aria-hidden":"true"}),a.jsx("div",{className:"absolute inset-0 rounded-[4px] bg-black/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),a.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center opacity-0 transition-opacity duration-500 ease-in-out group-hover:opacity-100",children:a.jsxs("svg",{viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg",className:"play-button h-[25px] w-[25px] transition-transform duration-700 sm:h-[30px] sm:w-[30px] ease-in-out",children:[a.jsx("circle",{cx:"30",cy:"30",r:"30",className:"fill-[#ffd875] transition-colors duration-200"}),a.jsx("path",{d:"M35.7461509,22.4942263 L45.1405996,36.5858994 C46.059657,37.9644855 45.6871354,39.8270935 44.3085493,40.7461509 C43.8157468,41.0746859 43.2367237,41.25 42.6444487,41.25 L23.8555513,41.25 C22.198697,41.25 20.8555513,39.9068542 20.8555513,38.25 C20.8555513,37.657725 21.0308654,37.078702 21.3594004,36.5858994 L30.7538491,22.4942263 C31.6729065,21.1156403 33.5355145,20.7431187 34.9141006,21.662176 C35.2436575,21.8818806 35.5264463,22.1646695 35.7461509,22.4942263 Z",fill:"#000000",transform:"translate(33.25, 30) rotate(-270) translate(-33.25, -30)"})]})}),a.jsxs("div",{className:"absolute bottom-2 lg:bottom-0 left-2 lg:left-1/2 transform -translate-x-0 lg:-translate-x-1/2 flex flex-col lg:flex-row z-20 text-[10px] lg:text-[11px] font-semibold leading-tight text-white gap-1 lg:gap-0",children:[a.jsx("span",{className:"whitespace-nowrap px-2 py-0.5 lg:py-1 rounded-md lg:rounded-none lg:rounded-tl-md bg-[#5e6070]","aria-label":`Tình trạng phim: ${e.episode_current}`,children:U(e.episode_current)}),a.jsx("span",{className:"whitespace-nowrap w-fit px-2 py-0.5 lg:py-1 rounded-md lg:rounded-none lg:rounded-tr-md bg-[#2ca35d]","aria-label":`Ngôn ngữ phim: ${e.lang}`,children:A(e.lang)})]}),a.jsx("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-3xl rounded-md py-1 px-2 shadow-md",children:a.jsxs("div",{className:"flex flex-row items-center gap-1 font-bold justify-center text-white text-[10px] lg:text-xs leading-tight",children:[a.jsx("p",{className:"text-[#f0d25c]",children:"IMDb"}),a.jsx("p",{className:"flex items-center",children:e.tmdb.vote_average===0?10:e.tmdb.vote_average.toFixed(1)})]})})]}),a.jsx("div",{className:"pt-2 pb-4",children:a.jsx("p",{className:"line-clamp-2 text-[13px] font-semibold text-gray-200 hover:text-[#ffd875]",title:e.name,children:e.name})})]},e._id)})}),v>1&&a.jsxs("nav",{className:"mt-8 flex flex-wrap items-center justify-center gap-2",children:[o>1&&a.jsx("button",{onClick:()=>f(o-1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang trước",disabled:i,children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:a.jsx("path",{fill:"currentColor",d:"m2 10l8 8l1.4-1.4L5.8 11H18V9H5.8l5.6-5.6L10 2z"})})}),k.map(e=>a.jsx("button",{onClick:()=>f(e),className:`flex h-8 w-8 items-center justify-center rounded-[4px] border text-sm ${o===e?"border-green-400 bg-green-500 text-white":"border-gray-600 bg-[#23252b] text-gray-300 hover:bg-gray-600"}`,disabled:i,children:e},e)),o<v&&a.jsx("button",{onClick:()=>f(o+1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang sau",disabled:i,children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:a.jsx("path",{fill:"currentColor",d:"M8.6 3.4L14.2 9H2v2h12.2l-5.6 5.6L10 18l8-8l-8-8z"})})})]})]})}export{Y as default};
