import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r}from"./index.BVOCwoKb.js";import{r as I,a as O}from"./movieUtils.BzFiPXDS.js";function Y({initialData:a,initialSlug:t,baseUrl:l,initialLimit:s,tittle:n}){const[i,o]=r.useState(a?.items||[]),[h,d]=r.useState(a?.params?.pagination||{current_page:1,total_pages:1}),[c,u]=r.useState(!1),[m,g]=r.useState(null),[x,p]=r.useState(!1),[b,v]=r.useState(t),[f,y]=r.useState((()=>({quoc_gia:a?.params?.filterCountry?.[0]||"",the_loai:a?.params?.filterCategory?.[0]||"",ngon_ngu:a?.params?.filterType?.[0]||"",nam_phat_hanh:a?.params?.filterYear?.[0]||"",sort_field:a?.params?.sortField||"_id",sort_type:a?.params?.sortType||"desc"}))),w=h.current_page;h.total_pages;const _=[{label:"Tất cả",value:""},...Array.from({length:(new Date).getFullYear()-1999+1},((e,a)=>({label:""+((new Date).getFullYear()-a),value:""+((new Date).getFullYear()-a)}))).sort(((e,a)=>parseInt(a.value)-parseInt(e.value)))],j=r.useCallback(((e=1)=>{const a=new URL(`${l}/v1/api/danh-sach/${b}`);return a.searchParams.set("page",e.toString()),a.searchParams.set("limit",s.toString()),f.sort_field&&a.searchParams.set("sort_field",f.sort_field),f.sort_type&&a.searchParams.set("sort_type",f.sort_type),f.ngon_ngu&&a.searchParams.set("sort_lang",f.ngon_ngu),f.the_loai&&a.searchParams.set("category",f.the_loai),f.quoc_gia&&a.searchParams.set("country",f.quoc_gia),f.nam_phat_hanh&&a.searchParams.set("year",f.nam_phat_hanh),a.toString()}),[f,l,b,s]),N=r.useCallback((async(e=1)=>{u(!0),g(null);try{const a=j(e),t=await fetch(a);if(!t.ok)throw new Error(`Lỗi khi fetch API: ${a} - Status: ${t.status}`);const l=await t.json();o(l.data?.items||[]),d(l.data?.params?.pagination||{current_page:1,total_pages:1});const r=new URL(`${window.location.origin}/loai-phim/${b}`);r.searchParams.set("page",e.toString()),r.searchParams.set("limit",s.toString()),f.sort_field?r.searchParams.set("sort_field",f.sort_field):r.searchParams.delete("sort_field"),f.sort_type?r.searchParams.set("sort_type",f.sort_type):r.searchParams.delete("sort_type"),f.ngon_ngu?r.searchParams.set("sort_lang",f.ngon_ngu):r.searchParams.delete("sort_lang"),f.the_loai?r.searchParams.set("category",f.the_loai):r.searchParams.delete("category"),f.quoc_gia?r.searchParams.set("country",f.quoc_gia):r.searchParams.delete("country"),f.nam_phat_hanh?r.searchParams.set("year",f.nam_phat_hanh):r.searchParams.delete("year"),window.history.pushState(null,"",r.toString())}catch{g("Không thể tải phim. Vui lòng thử lại."),o([])}finally{u(!1)}}),[j,f,s,b]),C=(e,a)=>{"loai_phim"===e?(v(a),y({quoc_gia:"",the_loai:"",ngon_ngu:"",nam_phat_hanh:"",sort_field:"_id",sort_type:"desc"})):y((t=>({...t,[e]:a})))},k=e=>{N(e)};return e.jsxs("div",{children:[e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"flex flex-row items-center justify-between gap-8 lg:justify-start",children:[e.jsx("h1",{className:"lg:text-xl text-lg font-semibold text-white",children:n}),e.jsxs("button",{onClick:()=>p(!x),className:"flex items-center gap-1 transition-all",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",className:"leading-none",children:e.jsx("path",{d:"M19 6H5c-1.1 0-1.4.6-.6 1.4l4.2 4.2c.8.8 1.4 2.3 1.4 3.4v5l4-2v-3.5c0-.8.6-2.1 1.4-2.9l4.2-4.2c.8-.8.5-1.4-.6-1.4"})}),e.jsx("span",{className:"text-xs font-medium leading-none text-white",children:"Bộ lọc"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"leading-none transition-transform duration-300 "+(x?"rotate-180":"rotate-0"),children:e.jsx("path",{d:"M12 13.172L18.364 6.808l1.414 1.414L12 16L4.222 8.222l1.414-1.414L12 13.172z"})})]})]}),x&&e.jsxs("div",{className:"mt-4 flex flex-col gap-4 text-xs text-white border border-gray-200/20 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Loại phim:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Tất cả",value:"phim"},{label:"Phim Lẻ",value:"phim-le"},{label:"Phim Bộ",value:"phim-bo"},{label:"Hoạt Hình",value:"hoat-hinh"},{label:"Phim Chiếu Rạp",value:"phim-chieu-rap"}].map((a=>e.jsx("button",{onClick:()=>C("loai_phim",a.value),className:"rounded-lg px-3 py-1.5 "+(b===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value)))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Quốc gia:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Tất cả",value:""},{label:"Việt Nam",value:"viet-nam"},{label:"Hàn Quốc",value:"han-quoc"},{label:"Mỹ",value:"my"},{label:"Trung Quốc",value:"trung-quoc"},{label:"Nhật Bản",value:"nhat-ban"},{label:"Thái Lan",value:"thai-lan"},{label:"Hồng Kông",value:"hong-kong"},{label:"Đài Loan",value:"dai-loan"},{label:"Ấn Độ",value:"an-do"},{label:"Anh",value:"anh"},{label:"Pháp",value:"phap"},{label:"Canada",value:"canada"},{label:"Đức",value:"duc"},{label:"Khác",value:"khac"}].map((a=>e.jsx("button",{onClick:()=>C("quoc_gia",a.value),className:"rounded-lg px-3 py-1.5 "+(f.quoc_gia===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value)))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Thể loại:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Tất cả",value:""},{label:"Cổ Trang",value:"co-trang"},{label:"Hành Động",value:"hanh-dong"},{label:"Học Đường",value:"hoc-duong"},{label:"Kinh Dị",value:"kinh-di"},{label:"Tâm Lý",value:"tam-ly"},{label:"Viễn Tưởng",value:"vien-tuong"},{label:"Phiêu Lưu",value:"phieu-luu"},{label:"Tình Cảm",value:"tinh-cam"},{label:"Hình Sự",value:"hinh-su"},{label:"Võ Thuật",value:"vo-thuat"},{label:"Hoạt Hình",value:"hoat-hinh"},{label:"Tài Liệu",value:"tai-lieu"},{label:"Khoa Học",value:"khoa-hoc"},{label:"Chiến Tranh",value:"chien-tranh"},{label:"Thần Thoại",value:"than-thoai"},{label:"Âm Nhạc",value:"am-nhac"},{label:"Gia Đình",value:"gia-dinh"},{label:"Thể Thao",value:"the-thao"},{label:"Bí Ẩn",value:"bi-an"},{label:"Lịch Sử",value:"lich-su"}].map((a=>e.jsx("button",{onClick:()=>C("the_loai",a.value),className:"rounded-lg px-3 py-1.5 "+(f.the_loai===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value)))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Ngôn ngữ:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{label:"Tất cả",value:""},{label:"Vietsub",value:"vietsub"},{label:"Thuyết Minh",value:"thuyet-minh"},{label:"Lồng Tiếng",value:"long-tieng"}].map((a=>e.jsx("button",{onClick:()=>C("ngon_ngu",a.value),className:"rounded-lg px-3 py-1.5 "+(f.ngon_ngu===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value)))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Năm sản xuất:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map((a=>e.jsx("button",{onClick:()=>C("nam_phat_hanh",a.value),className:"rounded-lg px-3 py-1.5 "+(f.nam_phat_hanh===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value)))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 font-semibold",children:"Sắp xếp:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[[{label:"Mới nhất (theo ID)",value:"_id"},{label:"Thời gian cập nhật",value:"modified.time"},{label:"Năm phát hành",value:"year"}].map((a=>e.jsx("button",{onClick:()=>C("sort_field",a.value),className:"rounded-lg px-3 py-1.5 "+(f.sort_field===a.value?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:a.label},a.value))),e.jsx("button",{onClick:()=>C("sort_type","desc"===f.sort_type?"asc":"desc"),className:"rounded-[4px] px-3 py-1 transition-colors duration-200 "+("desc"===f.sort_type?"border border-gray-700 text-[#ffd875]":"text-gray-200 hover:text-whtie "),children:"desc"===f.sort_type?"Giảm dần":"Tăng dần"})]})]}),e.jsxs("div",{className:"flex justify-start gap-2 mt-4",children:[e.jsx("button",{onClick:()=>{N(1)},className:"rounded-full border border-[#ffd785] bg-[#ffd785] px-4 py-2 text-xs font-semibold text-black",children:"Tìm Kiếm"}),e.jsx("button",{onClick:()=>p(!1),className:"rounded-full border border-white px-4 py-2 text-xs font-semibold text-white ",children:"Đóng"})]})]})]}),m&&e.jsx("div",{className:"mt-8 text-center text-red-500",children:m}),!c&&!m&&0===i.length&&e.jsx("div",{className:"mt-8 text-center text-gray-400",children:"Không tìm thấy phim nào phù hợp."}),!c&&!m&&i.length>0&&e.jsx("div",{className:"mt-4 grid grid-cols-3 gap-2 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",children:i.map((a=>{const t=`https://ik.imagekit.io/17mpki7mv/motchill/${a.poster_url}?tr=f-webp,w-300,h-450,fo-auto,q-85`;return e.jsxs("a",{href:`/phim/${a.slug}`,className:"group relative flex-shrink-0",children:[e.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden rounded-[4px]",children:[e.jsx("img",{src:t,alt:`Poster phim ${a.name}`,className:"h-full w-full object-cover",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 rounded-[4px] bg-black/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),e.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center opacity-0 transition-opacity duration-500 ease-in-out group-hover:opacity-100",children:e.jsxs("svg",{viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg",className:"play-button h-[25px] w-[25px] transition-transform duration-700 sm:h-[30px] sm:w-[30px] ease-in-out",children:[e.jsx("circle",{cx:"30",cy:"30",r:"30",className:"fill-[#ffd785] transition-colors duration-200"}),e.jsx("path",{d:"M35.7461509,22.4942263 L45.1405996,36.5858994 C46.059657,37.9644855 45.6871354,39.8270935 44.3085493,40.7461509 C43.8157468,41.0746859 43.2367237,41.25 42.6444487,41.25 L23.8555513,41.25 C22.198697,41.25 20.8555513,39.9068542 20.8555513,38.25 C20.8555513,37.657725 21.0308654,37.078702 21.3594004,36.5858994 L30.7538491,22.4942263 C31.6729065,21.1156403 33.5355145,20.7431187 34.9141006,21.662176 C35.2436575,21.8818806 35.5264463,22.1646695 35.7461509,22.4942263 Z",fill:"#000000",transform:"translate(33.25, 30) rotate(-270) translate(-33.25, -30)"})]})}),e.jsxs("div",{className:"absolute bottom-2 lg:bottom-0 left-2 lg:left-1/2 transform -translate-x-0 lg:-translate-x-1/2 flex flex-col lg:flex-row z-20 text-[10px] lg:text-[11px] font-semibold leading-tight text-white gap-1 lg:gap-0",children:[e.jsx("span",{className:"whitespace-nowrap px-2 py-0.5 lg:py-1 rounded-md lg:rounded-none lg:rounded-tl-md bg-[#5e6070]","aria-label":`Tình trạng phim: ${a.episode_current}`,children:I(a.episode_current)}),e.jsx("span",{className:"whitespace-nowrap w-fit px-2 py-0.5 lg:py-1 rounded-md lg:rounded-none lg:rounded-tr-md bg-[#2ca35d]","aria-label":`Ngôn ngữ phim: ${a.lang}`,children:O(a.lang)})]}),e.jsx("div",{className:"absolute top-2 left-2 bg-black/70 backdrop-blur-3xl rounded-md py-1 px-2 shadow-md",children:e.jsxs("div",{className:"flex flex-row items-center gap-1 font-bold justify-center text-white text-[10px] lg:text-xs leading-tight",children:[e.jsx("p",{className:"text-[#f0d25c]",children:"IMDb"}),e.jsx("p",{className:"flex items-center",children:0===a.tmdb.vote_average?10:a.tmdb.vote_average.toFixed(1)})]})})]}),e.jsx("div",{className:"pt-2 pb-4",children:e.jsx("p",{className:"line-clamp-2 text-[13px] font-semibold text-gray-200 hover:text-[#ffd785]",title:a.name,children:a.name})})]},a._id)}))}),e.jsxs("nav",{className:"mt-4 flex flex-wrap items-center justify-center gap-2",children:[w>1&&e.jsx("button",{onClick:()=>k(w-1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang trước",disabled:c,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"m2 10l8 8l1.4-1.4L5.8 11H18V9H5.8l5.6-5.6L10 2z"})})}),[1,2,3,4,5].map((a=>e.jsx("button",{onClick:()=>k(a),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border text-sm "+(w===a?"border-[#ffd785] text-white":"border-gray-600 bg-[#23252b] text-gray-300 hover:bg-gray-600"),disabled:c,children:a},a))),w<5&&e.jsx("button",{onClick:()=>k(w+1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang sau",disabled:c,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:e.jsx("path",{fill:"currentColor",d:"M8.6 3.4L14.2 9H2v2h12.2l-5.6 5.6L10 18l8-8l-8-8z"})})})]})]})}export{Y as default};