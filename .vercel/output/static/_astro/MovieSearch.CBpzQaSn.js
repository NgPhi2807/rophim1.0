import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.BVOCwoKb.js";import{r as z}from"./movieUtils.BzFiPXDS.js";const L="https://phimapi.com";function T({initialKeyword:i,initialPage:l=1}){const[g,c]=s.useState([]),[r,m]=s.useState(!0),[d,b]=s.useState(null),[N,p]=s.useState({current_page:l,total_pages:1,total_items:0,page_size:10}),[a,k]=s.useState(i),[x,j]=s.useState(l),w=s.useCallback(async(e,h)=>{if(!e){c([]),m(!1),p({current_page:1,total_pages:1,total_items:0,page_size:10});return}m(!0),b(null),c([]);try{const o=await fetch(`${L}/v1/api/tim-kiem?keyword=${encodeURIComponent(e)}&page=${h}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const _=await o.json();c(_.data?.items||[]),p(_.data?.params?.pagination||{current_page:1,total_pages:1,total_items:0,page_size:10});const S=`/tim-kiem?q=${encodeURIComponent(e)}&page=${h}`;window.history.pushState(null,"",S)}catch(o){console.error("Lỗi khi tải kết quả tìm kiếm:",o),b("Không thể tải kết quả tìm kiếm. Vui lòng thử lại."),c([]),p({current_page:1,total_pages:1,total_items:0,page_size:10})}finally{m(!1)}},[]);s.useEffect(()=>{(i!==a||l!==x)&&(k(i),j(l)),a&&w(a,x)},[a,x,w,i,l]);const u=e=>{j(e)},{current_page:n,total_pages:f,total_items:$}=N,y=[],v=Math.max(1,n-2),C=Math.min(f,v+4);for(let e=v;e<=C;e++)y.push(e);return t.jsxs("div",{className:"mx-auto text-white",children:[t.jsxs("h1",{className:"mb-6 text-lg lg:text-xl font-bold",children:["Kết quả tìm kiếm cho:",t.jsxs("span",{className:"text-[#ffd785]",children:['"',a,'"']})]}),r&&t.jsx("div",{className:"text-center text-gray-400",children:"Đang tải kết quả..."}),d&&t.jsx("div",{className:"text-center text-red-500",children:d}),!r&&!d&&g.length===0&&t.jsxs("div",{className:"text-center text-gray-400",children:['Không tìm thấy phim nào phù hợp với từ khóa "',a,'".']}),!r&&!d&&g.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6",children:g.map(e=>{const h=`https://ik.imagekit.io/17mpki7mv/motchill/${e.poster_url}?tr=f-webp,w-300,h-450,fo-auto,q-85`;return t.jsxs("a",{href:`/phim/${e.slug}`,className:"group relative flex-shrink-0",children:[t.jsxs("div",{className:"relative aspect-[2/3] w-full overflow-hidden rounded-[4px]",children:[t.jsx("img",{src:h,alt:`Poster phim ${e.name}`,className:"h-full w-full object-cover",loading:"lazy"}),t.jsx("div",{className:"absolute bottom-0 left-0 h-[40%] w-full rounded-b-[4px]",style:{background:"linear-gradient(to top,rgba(30, 30, 30, 0.8) 5%, transparent 100%)"},"aria-hidden":"true"}),t.jsx("div",{className:"absolute inset-0 rounded-[4px] bg-black/20 opacity-0 transition-opacity duration-300 group-hover:opacity-100"}),t.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center opacity-0 transition-opacity duration-500 ease-in-out group-hover:opacity-100",children:t.jsxs("svg",{viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg",className:"play-button h-[25px] w-[25px] transition-transform duration-700 sm:h-[30px] sm:w-[30px] ease-in-out",children:[t.jsx("circle",{cx:"30",cy:"30",r:"30",className:"fill-[#ffd785] transition-colors duration-200"}),t.jsx("path",{d:"M35.7461509,22.4942263 L45.1405996,36.5858994 C46.059657,37.9644855 45.6871354,39.8270935 44.3085493,40.7461509 C43.8157468,41.0746859 43.2367237,41.25 42.6444487,41.25 L23.8555513,41.25 C22.198697,41.25 20.8555513,39.9068542 20.8555513,38.25 C20.8555513,37.657725 21.0308654,37.078702 21.3594004,36.5858994 L30.7538491,22.4942263 C31.6729065,21.1156403 33.5355145,20.7431187 34.9141006,21.662176 C35.2436575,21.8818806 35.5264463,22.1646695 35.7461509,22.4942263 Z",fill:"#000000",transform:"translate(33.25, 30) rotate(-270) translate(-33.25, -30)"})]})}),t.jsx("div",{className:"absolute bottom-1 left-1 z-10",children:e.episode_current&&t.jsx("span",{className:"z-20 px-0.5 py-0.5 text-[12px] font-bold leading-tight text-white drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]",children:z(e.episode_current)})})]}),t.jsx("div",{className:"pb-4 pt-2",children:t.jsx("p",{className:"line-clamp-2 text-[13px] font-semibold text-gray-200 hover:text-[#ffd785]",title:e.name,children:e.name})})]},e._id)})}),f>1&&t.jsxs("nav",{className:"mt-8 flex flex-wrap items-center justify-center gap-2",children:[n>1&&t.jsx("button",{onClick:()=>u(n-1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang trước",disabled:r,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:t.jsx("path",{fill:"currentColor",d:"m2 10l8 8l1.4-1.4L5.8 11H18V9H5.8l5.6-5.6L10 2z"})})}),y.map(e=>t.jsx("button",{onClick:()=>u(e),className:`flex h-8 w-8 items-center justify-center rounded-[4px] border text-sm ${n===e?"border-green-400 bg-green-500 text-white":"border-gray-600 bg-[#23252b] text-gray-300 hover:bg-gray-600"}`,disabled:r,children:e},e)),n<f&&t.jsx("button",{onClick:()=>u(n+1),className:"flex h-8 w-8 items-center justify-center rounded-[4px] border border-gray-600 bg-[#23252b] text-sm text-gray-300 hover:bg-gray-600","aria-label":"Trang sau",disabled:r,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 20 20",children:t.jsx("path",{fill:"currentColor",d:"M8.6 3.4L14.2 9H2v2h12.2l-5.6 5.6L10 18l8-8l-8-8z"})})})]})]})]})}export{T as default};
